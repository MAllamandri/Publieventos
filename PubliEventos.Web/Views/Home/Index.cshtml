@{
    ViewBag.Title = "Inicio";
    Layout = "~/Views/Shared/_LayoutPublieventos.cshtml";
}

@using PubliEventos.Contract.Class

@System.Web.Optimization.Scripts.Render("~/bundles/Select2")
@System.Web.Optimization.Scripts.Render("/ViewScripts/Shared/Social.js")
@System.Web.Optimization.Scripts.Render("/ViewScripts/Home/Index.js")
@System.Web.Optimization.Scripts.Render("/Scripts/moment.js")
@System.Web.Optimization.Scripts.Render("/Scripts/moment-with-locales.js")
@System.Web.Optimization.Scripts.Render("/Scripts/bootstrap-datetimepicker.js")

@System.Web.Optimization.Styles.Render("~/bundles/Select2-css")
@System.Web.Optimization.Styles.Render("~/Content/bootstrap/css/bootstrap-datetimepicker.min.css")

<script type="text/javascript">
    var events = @Html.Raw(Newtonsoft.Json.JsonConvert.SerializeObject((List<Event>)ViewBag.events))
    var url = @Html.Raw(Newtonsoft.Json.JsonConvert.SerializeObject(string.Format("{0}://{1}/Event/Detail/{2}", System.Web.HttpContext.Current.Request.Url.Scheme, System.Web.HttpContext.Current.Request.Url.Authority, "#")))
    var urlImage = @Html.Raw(Newtonsoft.Json.JsonConvert.SerializeObject(string.Format("{0}://{1}{2}", System.Web.HttpContext.Current.Request.Url.Scheme, System.Web.HttpContext.Current.Request.Url.Authority, System.Configuration.ConfigurationManager.AppSettings["PathCovers"] + '#')))
    var currentUserId = @((User as PubliEventos.Web.App_Start.CustomPrincipal) != null ? (User as PubliEventos.Web.App_Start.CustomPrincipal).Id : 0);
</script>

<div class="row">
    <div class="col-md-12">
        <div class="row event-band">
            <div class="col-md-12 search-row">
                <div class="form-group search-form" id="search-form" style="display: none;">
                    <div class="row form-group margin-top-normal">
                        <div class="col-md-6">
                            @Html.Label("FECHA DESDE", new { @class = "label-desciption" })
                            <div class="input-group">
                                @Html.TextBox("StartDate", null, new { @class = "date form-control" })
                                <span class="input-group-addon"><span class="icon-calendar"></span></span>
                            </div>
                        </div>
                        <div class="col-md-6">
                            @Html.Label("FECHA HASTA", new { @class = "label-desciption" })
                            <div class="input-group">
                                @Html.TextBox("EndDate", null, new { @class = "date form-control" })
                                <span class="input-group-addon"><span class="icon-calendar"></span></span>
                            </div>
                        </div>
                    </div>
                    <div class="row form-group">
                        <div class="col-md-6">
                            @Html.Label("TIPO DE EVENTO", new { @class = "label-desciption" })
                            @Html.DropDownList("EventType", (SelectList)ViewBag.eventTypes, "[Seleccione Tipo Evento]", new { @class = "select-list form-control" })
                        </div>
                        <div class="col-md-6">
                            @Html.Label("USUARIO", new { @class = "label-desciption" })
                            @Html.TextBox("UserName", null, new { @class = "form-control select2-users" })
                        </div>
                    </div>
                    <div class="row  form-group">
                        <div class="col-md-12">
                            <a style="float: right; margin-top: 2px;" href="/Home/SearchEventsByDistance">Búsqueda por Aproximación</a>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-12">
                            <input style="margin-top: 15px" id="resetFilters" value="Resetear Búsqueda" type="button" class="btn-cancel" />
                            <input id="search" style="margin-top: 15px" value="Buscar" type="button" class="btn-confirm pull-right" />
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-12 bar-search">
                <div id="searchButton" class="search-title"><i class="icon-caret-down" id="icon-search"></i>&nbspBÚSQUEDAS</div>
            </div>
            <div class="col-md-12" data-bind="foreach:Events">
                <div class="col-md-12 date-description" data-bind="text: Date"></div>
                <div class="col-md-12" data-bind="foreach: EventsDetail">
                    @Html.Partial("Partial/_EventMosaic")
                </div>
            </div>
            <div data-bind="visible: viewModel.Events().length == 0" class="col-md-12" style="text-align: center">
                <p class="not-found-message">NO HAY EVENTOS DISPONIBLES</p>
            </div>
        </div>
    </div>
</div>
